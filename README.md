# Yadladoc: reliable, tested code snippets in your documentation
Inspired by [knit](https://github.com/Kotlin/kotlinx-knit), [mdoc](https://github.com/scalameta/mdoc), [mdx](https://github.com/realworldocaml/mdx) 

## Usage
### Basics
Yadladoc requires a `.ydoc` folder at the place of execution. You can leave it empty for the default configuration

- Run `java -jar ydoc.jar run README.md` to generate code from the code snippets in `README.md`

- Run `java -jar ydoc.jar check README.md` to check that the existing code matches what would be generated by a run on `README.md`

### Marking a snippet as an example
yadladoc will use snippets marked with the property `ydoc.example=<name>` and ignore the other. Snippets sharing the same `<name>` will be grouped in the same example file named after `<name>` and the language of the snippet.

````markdown
# Example
Here is a snippet that would generate an examples/add.py file

```python ydoc.example=examples/add
def add(a: int, b: int) -> int:
        return a + b
```

And here is one that would be ignored:
```python
def hey():
        print("Hey")
```
````

### Templates
**TODO**

## Install
### From source
Run `make usage/ydoc.jar` to produce the executable jar `ydoc.jar` in `usage/`

### From the release jar
**COMING SOON**
### From the release binary
**COMING SOON**

## Contribute
### Test suites
`YadladocSuite` groups the high level 'end to end' tests an should be a good entrypoint to have an overview of the current features. The other suites focus on more technical modules, such as Mardkwown parsing. AssertExtensions and SuiteExtensions are test-only helpers (see section [Notes on the test style])

### Reading the tests
Most tests are written with a thin wrapper around munit assertions in a 'state what you expect' style.
Statements like these:
```scala ydoc.example=yadladoc/test/src/nyub/yadladoc/examples/assertions ydoc.prefix=test
        42 isEqualTo 42
```
Are equivalent to
```scala ydoc.example=yadladoc/test/src/nyub/yadladoc/examples/assertions
        assertEquals(42, 42)
```

Since Yadladoc produces files, tests in YadladocSuite make heavy usage of `hasContent`:
```scala ydoc.example=yadladoc/test/src/nyub/yadladoc/examples/assertions ydoc.prefix=test
        val file = Files.createTempDirectory("test").resolve("ok.txt")
        Files.writeString(file, "Line1\nLine2")
        file hasContent "Line1\nLine2" // entire content
        file hasContent List("Line1", "Line2") // line by line
```
equivalent to
```scala ydoc.example=yadladoc/test/src/nyub/yadladoc/examples/assertions
        assertEquals(Files.readString(file), "Line1\nLine2")
```
